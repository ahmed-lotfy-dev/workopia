app: workopia
repo: git@github.com:ahmed-lotfy-dev/workopia.git
branch: main
php: "8.4"

server:
  user: www-data
  path: /app

tasks:
  pre-deploy:
    - echo "Installing composer dependencies..."
    - composer install --no-dev --optimize-autoloader
    - echo "Setting storage permissions..."
    - chown -R www-data:www-data storage bootstrap/cache
    - chmod -R 775 storage bootstrap/cache

  post-deploy:
    - echo "Clearing Laravel caches..."
    - php artisan config:clear
    - php artisan cache:clear
    - php artisan view:clear
    - php artisan route:clear
    - php artisan config:cache
    - echo "Running migrations..."
    - php artisan migrate --force